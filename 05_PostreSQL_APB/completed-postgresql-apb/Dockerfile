FROM ansibleplaybookbundle/apb-base:canary
# MAINTAINER {{ $MAINTAINER }}

LABEL "com.redhat.apb.spec"=\
"dmVyc2lvbjogMS4wCm5hbWU6IHBvc3RncmVzcWwtYXBiCmRlc2NyaXB0aW9uOiBTQ0wgUG9zdGdy\
ZVNRTCBhcGIgaW1wbGVtZW50YXRpb24KYmluZGFibGU6IHRydWUKYXN5bmM6IG9wdGlvbmFsCm1l\
dGFkYXRhOgogIGRvY3VtZW50YXRpb25Vcmw6IGh0dHBzOi8vd3d3LnBvc3RncmVzcWwub3JnL2Rv\
Y3MvCiAgbG9uZ0Rlc2NyaXB0aW9uOiBBbiBhcGIgdGhhdCBkZXBsb3lzIHBvc3RncmVzcWwgOS40\
LCA5LjUsIG9yIDkuNi4KICBkaXNwbGF5TmFtZTogUG9zdGdyZVNRTCBEZXZDb25mIChBUEIpCiAg\
aW1hZ2VVcmw6IGh0dHBzOi8vZGV2Y29uZi5jei9pbWFnZXMvaWNvbi9jei9kZXZjb25mLWN6LWlj\
b24ucG5nCnBsYW5zOgogIC0gbmFtZTogZGVmYXVsdAogICAgZGVzY3JpcHRpb246IEEgc2luZ2xl\
IERCIHNlcnZlciB3aXRoIG5vIHN0b3JhZ2UKICAgIGZyZWU6IHRydWUKICAgIG1ldGFkYXRhOgog\
ICAgICBkaXNwbGF5TmFtZTogRGV2ZWxvcG1lbnQKICAgICAgbG9uZ0Rlc2NyaXB0aW9uOiBUaGlz\
IHBsYW4gcHJvdmlkZXMgYSBzaW5nbGUgbm9uLUhBIFBvc3RncmVTUUwgc2VydmVyIHdpdGhvdXQg\
cGVyc2lzdGVudCBzdG9yYWdlCiAgICAgIGNvc3Q6ICQwLjAwCiAgICBwYXJhbWV0ZXJzOgogICAg\
ICAtIG5hbWU6IHBvc3RncmVzcWxfZGF0YWJhc2UKICAgICAgICBkZWZhdWx0OiBhZG1pbgogICAg\
ICAgIHR5cGU6IHN0cmluZwogICAgICAgIHRpdGxlOiBQb3N0Z3JlU1FMIERhdGFiYXNlIE5hbWUK\
ICAgICAgICByZXF1aXJlZDogdHJ1ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfdXNlcgogICAg\
ICAgIGRlZmF1bHQ6IGFkbWluCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgVXNlcgogICAgICAg\
IHR5cGU6IHN0cmluZwogICAgICAgIG1heGxlbmd0aDogNjMKICAgICAgICByZXF1aXJlZDogdHJ1\
ZQogICAgICAtIG5hbWU6IHBvc3RncmVzcWxfcGFzc3dvcmQKICAgICAgICB0eXBlOiBzdHJpbmcK\
ICAgICAgICBkZXNjcmlwdGlvbjogQSByYW5kb20gYWxwaGFudW1lcmljIHN0cmluZyBpZiBsZWZ0\
IGJsYW5rCiAgICAgICAgdGl0bGU6IFBvc3RncmVTUUwgUGFzc3dvcmQKICAgICAgICBkaXNwbGF5\
X3R5cGU6IHBhc3N3b3JkCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKICAgICAgLSBuYW1lOiBwb3N0\
Z3Jlc3FsX3ZlcnNpb24KICAgICAgICBkZWZhdWx0OiAnOS42JwogICAgICAgIGVudW06IFsnOS42\
JywgJzkuNScsICc5LjQnXQogICAgICAgIHR5cGU6IGVudW0KICAgICAgICB0aXRsZTogUG9zdGdy\
ZVNRTCBWZXJzaW9uCiAgICAgICAgcmVxdWlyZWQ6IHRydWUKCg=="


COPY roles /opt/ansible/roles
COPY playbooks/* /opt/apb/actions/
RUN chmod -R g=u /opt/{ansible,apb}

USER apb
